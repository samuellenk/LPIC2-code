---
title: "Praxis-Beispiel: DHCP-Konfiguration ![](images/LPIC2_logo.png){width=20 height=20}"
subtitle: "LPIC 2"
author: "![SL](images/SL_foto_300.png){width=20 height=20} [&copy; Samuel Lenk](https://linux-trainings.de/)"
theme: "Luebeck"
colortheme: "whale"
aspectratio: 169
colorlinks: true
urlcolor: gray
linkcolor: gray
---

# Einleitung

In diesem Abschnitt konfigurieren wir einen IPv4‑DHCP‑Server für ein Subnetz, damit Clients von diesem DHCP-Leases erhalten.

# Voraussetzung

- zwei Systeme (VMs)
- DHCP-Server auf Debian 13
- DHCP-Client auf LinuxMint 10
- die Schritte sollten aber (nahezu) deckungsgleich auf anderen Distributionen anwendbar sein

# Installation

```bash
sudo apt -y install isc-dhcp-server
sudo dnf -y install dhcp
```

# Service aktivieren & starten

Status:
```bash
systemctl status isc-dhcp-server   # kurzer Status‑Check
```

Start & Enable
```bash
systemctl enable isc-dhcp-server   # beim Booten starten
systemctl start isc-dhcp-server    # sofort starten
```

# Original‑Konfiguration sichern

```bash
cp /etc/dhcp/dhcpd.conf /etc/dhcp/dhcpd.conf.bak
```

# Minimal‑Konfiguration schreiben

```bash
cat > /etc/dhcp/dhcpd.conf <<'EOF'
# /etc/dhcp/dhcpd.conf – Basis‑IPv4‑DHCP‑Konfiguration
default-lease-time 600;
max-lease-time 7200;
authoritative;

subnet 192.168.10.0 netmask 255.255.255.0 {
    range 192.168.10.20 192.168.10.100;
    option routers 192.168.10.1;
    option subnet-mask 255.255.255.0;
    option domain-name-servers 8.8.8.8, 8.8.4.4;
    option domain-name "example.local";
}
EOF
```

# Schnittstelle für Daemon festlegen

Debian/Ubuntu:
```bash
sed -i 's/^INTERFACESv4=""/INTERFACESv4="eth0"/' /etc/default/isc-dhcp-server
```

RHEL/CentOS:
```bash
sed -i 's/^DHCPD_INTERFACE=.*/DHCPD_INTERFACE="eth0"/' /etc/sysconfig/dhcpd
```

- bitte `eth0` durch die tatsächliche LAN‑Schnittstelle ersetzen

# Änderungen für Daemon übernehmen

```bash
systemctl restart isc-dhcp-server
systemctl status isc-dhcp-server
```

# Lease‑Datei prüfen

```bash
less /var/lib/dhcp/dhcpd.leases
```

# Test vom Client im selben Netzwerk

DHCP‑Request erzwingen:
```bash
dhclient -v eth0
```

IP‑Adresse prüfen:
```bash
ip addr show eth0
```

Lease freigeben:
```bash
dhclient -r
```

# Live‑DHCP‑Traffic beobachten

Debug‑Hilfe:
```bash
apt install tcpdump
tcpdump -i eth0 -n port 67 or port 68
```

# Weitere Befehle und Themen

- Konfiguration prüfen: `dhcpd -t -cf /etc/dhcp/dhcpd.conf`
- Zusätzliche **option**‑Einträge: zum Beispiel `option ntp-servers`, `option netbios-name-servers`
- **DHCP‑Relay** (`dhcrelay`) für Subnetze über Router hinweg
- **IPv6 DHCPv6**: `dhcpd6`, `dhcpd6.conf`
- **statische Bindings**: `host`‑Einträge mit `hardware ethernet` und `fixed-address`
- **Dynamic DNS Updates**: `ddns-update-style`, `nsupdate`
- Logging via `/var/log/syslog` oder `/var/log/messages`; `log-facility`‑Direktive
- Firewall‑Regeln, wie `iptables -A INPUT -p udp --dport 67 -j ACCEPT`
- Fehlersuche: `systemctl status`, `journalctl -u isc-dhcp-server`
